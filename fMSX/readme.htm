<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2"/>
    <meta name="keywords" content="akop, karapetyan, psp, playstation, play, station, portable, emulator, emulation, emulate, msx, fmsx, fmsx-psp, fmsxpsp"/>
    <meta name="author" content="Akop Karapetyan"/>
    <meta name="description" content=""/>
    <title>fMSX PSP</title>
    <style type="text/css">
      body
      {
        margin: 1em;
        font-family: sans-serif;
        font-size: 10pt;
        background-color: #fbfaf4;
      }

      #content
      {
        background-color: #ffffff;
        padding: 2em 2em 2em 2em;
        margin: 4em 4em 0.5em 4em;
        border: solid 1px #aaaaaa;
      }

      #header 
      {
        border-bottom: solid 1px #cccccc;
      }

      #title
      {
        font-weight: bold;
        font-family: serif;
        font-size: 24pt;
      }

      #byline
      {
        font-family: serif;
        font-size: 10pt;
        font-style: oblique;
      }

      #authors
      {
        font-size: 9pt;
        font-style: oblique;
      }
                  
      h1
      {
        font-size: 14pt;
      }

      h2
      {
        font-size: 12pt;
      }

      h4
      {
        margin-left: 1em;
      }
      
      #introduction 
      {
        font-style: oblique;
      }
      
      #footer
      {
        font-style: oblique;
        margin-left: 4em;
      }
      
      table
      {
        margin-left: 2em;
      }
      
      table td
      {
        padding-left: 1em;
        padding-right: 1em;
      }
      
      table td:first-child
      {
        font-style: oblique;
      }
      
      a
      {
        color: #5C3317;
      }
      
      p
      {
        margin-left: 1em;
      }

      #top p
      {
        margin-left: 0;
      }
    </style>
  </head>
  <body>
    <div id="content">

      <div id="header">
        <div id="title">fMSX PSP</div>
        <div id="byline">MSX emulator for PlayStation Portable</div>
      </div>

      <div id="top">
        <p><a href="http://psp.akop.org/fmsx">http://psp.akop.org/fmsx</a></p>
        <div id="authors"><p>(C) 2007 Akop Karapetyan (port)<br/>
(C) 1994-2007 Marat Fayzullin (emulation)</p></div>
        <div id="introduction">
          <p><strong>fMSX <span class="caps">PSP</span></strong> is a port of the <a href="http://fms.komkon.org/fMSX/">fMSX emulator</a> to the Sony PlayStation Portable platform. It&#8217;s written in C and uses GU (Graphical Utility toolkit) for rendering.</p>
        </div>
      </div>

      <h2>Table of Contents</h2>
      <ol>
        <li><a href="#NewFeatures">New Features</a></li>
        <li><a href="#Installation">Installation</a></li>
        <li><a href="#Controls">Controls</a></li>
        <li><a href="#DiskWriting">Disk Writing</a></li>
        <li><a href="#MultiVolumeDiskImages">Multi-Volume Disk Images</a></li>
        <li><a href="#Troubleshooting">Troubleshooting</a></li>
        <li><a href="#Compiling">Compiling</a></li>
        <li><a href="#VersionHistory">Version History</a></li>
        <li><a href="#Credits">Credits</a></li>
        <li><a href="#Thanks">Thanks</a></li>
      </ol>

      <h2 id="NewFeatures">New Features</h2>


	<h4>Version 3.4.1 (October 01 2007)</h4>


	<ul>
	<li>fMSX upgraded to version 3.4</li>
		<li>Changes include fixes to the <span class="caps">Z80 CPU</span> emulation</li>
	</ul>


	<h2 id="Installation">Installation</h2>


	<p>Unzip fmsxpsp.zip into /PSP/GAME/ folder on the memory stick.</p>


	<p>fMSX <span class="caps">PSP</span> supports cartridge and disk loading from <span class="caps">ZIP</span> files. System <span class="caps">ROM</span>&#8217;s may reside in a <span class="caps">SYSTEM</span>.ZIP file in the same folder as <span class="caps">EBOOT</span>.PBP. <span class="caps">PAINTER</span>.ROM, or <span class="caps">MSXDOS2</span>.ROM may also be zipped, but must reside in separate <span class="caps">ZIP</span> files (FMPAC.ZIP, <span class="caps">MSXDOS2</span>.ZIP, etc..). fMSX <span class="caps">PSP</span> will attempt to load the three automatically if free cartridge slots are available. All other game <span class="caps">ROM</span> files must reside in separate <span class="caps">ZIP</span> files.</p>


	<h2 id="Controls">Controls</h2>


	<p>fMSX <span class="caps">PSP</span> currently &#8220;ships&#8221; with the following default key mappings:</p>


	<p>During emulation:</p>


	<table>
		<tr>
			<td> Analog stick </td>
			<td> Joystick up/down/left/right </td>
		</tr>
		<tr>
			<td> Directional pad </td>
			<td> Keyboard up/down/left/right </td>
		</tr>
		<tr>
			<td> [ ] (square) </td>
			<td> Joystick button A </td>
		</tr>
		<tr>
			<td> X (cross) </td>
			<td> Joystick button B </td>
		</tr>
		<tr>
			<td> O (circle) </td>
			<td> Spacebar </td>
		</tr>
		<tr>
			<td> [R] </td>
			<td> Displays the virtual keyboard, for as long as the button is held </td>
		</tr>
		<tr>
			<td> [L] + [R] </td>
			<td> Return to emulator menu </td>
		</tr>
		<tr>
			<td> Select + [L] </td>
			<td> Selects previous disk volume (for multi-volume disk sets) </td>
		</tr>
		<tr>
			<td> Select + [R] </td>
			<td> Selects next disk volume (for multi-volume disk sets) </td>
		</tr>
		<tr>
			<td> Start </td>
			<td> F1 </td>
		</tr>
	</table>




	<p>When the virtual keyboard is on:</p>


	<table>
		<tr>
			<td> Directional pad </td>
			<td> select virtual button </td>
		</tr>
		<tr>
			<td> [ ] (square) </td>
			<td> press a virtual button </td>
		</tr>
		<tr>
			<td> O (circle) </td>
			<td> &#8216;stick&#8217; a sticky virtual button </td>
		</tr>
		<tr>
			<td> ^ (triangle) </td>
			<td> unstick all stuck virtual buttons </td>
		</tr>
	</table>




	<p>Certain virtual buttons (specifically, <span class="caps">SHIFT</span>, CTRL and <span class="caps">GRAPH</span>) are &#8220;sticky&#8221; &#8211; the virtual button remains held down when O (circle) is tapped. Tapping O (circle) again releases the virtual button. This allows <span class="caps">SHIFT</span>, CTRL and <span class="caps">GRAPH</span> all to be held down at the same time, while the user presses another virtual button. To unstick all sticky buttons, press ^ (triangle).</p>


	<p>Keyboard mappings can be modified for each game. By default, button configuration changes are not retained after a mapping is modified. To save changes, press O (circle) after desired mapping is configured. To set the mapping as the default mapping, press [ ] (square) &#8211; to load the default mapping press ^ (triangle).</p>


	<h2 id="DiskWriting">Disk Writing</h2>


	<p>Versions of fMSX prior to 3.3 mapped <span class="caps">MSX</span> disk sectors to the file containing the disk image, and reads/writes to the <span class="caps">MSX</span> disk were implemented as reads/writes to the image on the storage device (in this case, the memory stick).</p>


	<p>Version 3.3 of fMSX includes a much more faithful emulation of the floppy disk controller, which no longer involves direct writing to the storage device &#8211; the disk image is loaded into memory instead. Versions 3.3.1 and 3.3.2 of fMSX stopped automatically writing the changes to disk &#8211; starting with 3.3.25, disk changes need to be explicitly committed to memory stick. This can either be done by loading a new disk in the same slot via the System tab (not the Game tab), or by ejecting the disk. Either way, you will be asked if you want to commit the changes to the image before ejecting or loading another image.</p>


	<p><strong><span class="caps">NOTE</span></strong> This only applies to uncompressed disk images &#8211; <span class="caps">ZIP</span> compressed files cannot be updated</p>


	<p><strong><span class="caps">WARNING</span></strong> Before committing changes to storage, make sure the <span class="caps">MSX</span> floppy drive is not in use &#8211; otherwise, you may damage the disk image</p>


	<h2 id="MultiVolumeDiskImages">Multi-Volume Disk Images</h2>


	<p>fMSX <span class="caps">PSP</span> can load multi-volume games (like Snatcher) from a single <span class="caps">ZIP</span> file. To load such a game, store all files in the same <span class="caps">ZIP</span>. It is important that the archived files are numbered 1-0, with &#8216;0&#8217; representing the 10th volume (archiving sequence is not important) &#8211; fMSX <span class="caps">PSP</span> will attempt to load the first disk in the sequence. As an example, a <span class="caps">ZIP</span> file could contain the following disk images:</p>


	<table>
		<tr>
			<td> thsnatj1.dsk </td>
		</tr>
		<tr>
			<td> thsnatj2.dsk </td>
		</tr>
		<tr>
			<td> thsnatj3.dsk </td>
		</tr>
	</table>




	<p>To switch disks mid-game, map any of the buttons to the &#8216;Special: Previous volume&#8217; or &#8216;Special: Next volume&#8217; actions in the control menu. When a &#8216;volume switch&#8217; button is pressed, and the next disk image in the sequence is found, an icon will appear with the number of the volume loaded.
Note that multi-volume files do not have to be <span class="caps">ZIP</span>-compressed for the &#8216;volume switch&#8217; feature to work &#8211; volume switching will also work for uncompressed <span class="caps">DSK</span> files, as long as they&#8217;re named as described above.</p>


	<p><strong><span class="caps">NOTE</span></strong> Changes to the disk image will not be saved when using this feature.</p>


	<h2 id="Troubleshooting">Troubleshooting</h2>


	<p>fMSX <span class="caps">PSP</span> may refuse to load a save state due to a number of different reasons. Some of the reasons follow:</p>


	<ul>
	<li>fMSX save state format has changed</li>
		<li>Currently set <span class="caps">RAM</span>/VRAM sizes do not match with <span class="caps">RAM</span>/VRAM settings set when the state was saved. This can be rectified by resetting <span class="caps">RAM</span>/VRAM sizes and loading again</li>
		<li>System model (MSX1/2/2+) currently set does not match the system model set when the state was saved. Reset the setting and try again</li>
		<li>System <span class="caps">ROM</span>&#8217;s currently in use do not match to those used when the state was saved. Replace the system <span class="caps">ROM</span>&#8217;s and try again</li>
		<li>Any combination of the above</li>
	</ul>


	<h2 id="Compiling">Compiling</h2>


	<p>Source code for fMSX <span class="caps">PSP</span> is available via a Subversion (SVN) repository. To check out a particular version, run</p>


	<p><code>svn co http://svn.akop.org/psp/tags/fms/date</code></p>


	<p>where <em>date</em> is the date of a particular version&#8217;s release, in <em>DD.MM.YYYY</em> format (20.04.2007, for example). Note that for this to work, you need to have Subversion installed.</p>


	<p>To compile fMSX <span class="caps">PSP</span>, you will need <a href="svn://svn.pspdev.org/psp/trunk/zlib">zlib</a> (svn://) and <a href="svn://svn.pspdev.org/psp/trunk/libpng">libpng</a> (svn://).</p>


	<p>To enable the alternate sound engines, <code>#define MSXAUDIO</code> and <code>MSXMUSIC</code>.
To enable zipped <span class="caps">ROM</span> support, <code>#define MINIZIP</code>.</p>


	<h2 id="VersionHistory">Version History</h2>


	<h4>3.3.25 (August 23 2007)</h4>


	<ul>
	<li>This update adds the ability to write changes to (uncompressed) disk images (see section on Disk Writing in the documentation for details and warnings)</li>
	</ul>


	<h4>3.3.2 (July 24 2007)</h4>


	<ul>
	<li>60% increase in rendering speed&#8212;MSX2 titles run at 100% speed at 222MHz</li>
		<li>Fixed buffer overflow error affecting units without a battery (thanks to Alpha Beta for tracking it down)</li>
	</ul>


	<h4>3.3.1 (June 17 2007)</h4>


	<ul>
	<li>Virtual keyboard improvements. The virtual keyboard now requires an external file &#8211; &#8216;msx.lyt&#8217; in the emulator directory&#8212;the file contains keyboard layout information</li>
		<li>fMSX updated to version 3.3</li>
		<li>Lots of minor bug fixes</li>
	</ul>


	<h4>3.2.1 (June 04 2007)</h4>


	<ul>
	<li>Added menu navigation options &#8211; select from <span class="caps">US PSP</span> navigation (X confirms, O cancels) or Japanese <span class="caps">PSP</span> navigation (O confirms, X cancels&#8212;also used by most homebrew emulators)</li>
		<li>Added <span class="caps">RAM</span>/VRAM adjustment options</li>
		<li>Added HBlank/VBlank period selection (PAL/NTSC)</li>
		<li>Added <span class="caps">MSX</span> model selection (MSX1, <span class="caps">MSX2</span>, MSX2+)</li>
		<li>Improved accuracy of frames-per-second counter</li>
		<li>User interface improvements</li>
		<li>fMSX updated to version 3.2</li>
		<li>Rendering speed increase, switched to 15bit color (these mostly affect menu rendering)</li>
		<li>Various bug fixes</li>
	</ul>


	<h4>3.1.3 (May 05 2007)</h4>


	<ul>
	<li>Support for multi-volume disk images &#8211; multiple disk images per <span class="caps">ZIP</span> file and in-game volume switching</li>
		<li>Improved virtual keyboard navigation, rendering speed increase</li>
		<li>System <span class="caps">ROM</span>&#8217;s can be stored in a single <span class="caps">ZIP</span> file in the application&#8217;s directory</li>
		<li>Integrated zipped <span class="caps">ROM</span> and <span class="caps">DSK</span> file support (fast loading from <span class="caps">ZIP</span> files)</li>
		<li><span class="caps">PSG</span>/SCC sound emulation engine by Mitsutaka Okazaki</li>
		<li>Approximately 18% gain in rendering speed</li>
		<li>Frames-per-second counter</li>
		<li><span class="caps">PAL</span> (50Hz) timing</li>
		<li>Various small improvements and bugfixes</li>
	</ul>


	<h4>3.1.2 (April 24 2007)</h4>


	<ul>
	<li>Added support for cartridge type selection in the System menu. This adds support for games like Zanac Ex, which are not detected correctly</li>
		<li>Preliminary <span class="caps">ZIP</span> file support. Emulator will load <span class="caps">ROM</span> or <span class="caps">DSK</span> files from a <span class="caps">ZIP</span> file, provided there&#8217;s only a single compressed file per <span class="caps">ZIP</span>. System ROMs must still be uncompressed (or GZip compressed)</li>
		<li>GZip file support &#8211; emulator will load cartridges and disk images from .gz compressed files. Save states are also much smaller in size</li>
		<li><span class="caps">GUI</span> changes, wording changes</li>
	</ul>


	<h4>3.1.1 (April 20 2007)</h4>


	<ul>
	<li>Initial release</li>
	</ul>


	<h2 id="Credits">Credits</h2>


	<table>
		<tr>
			<td> Marat Fayzullin </td>
			<td> fMSX </td>
		</tr>
		<tr>
			<td> Simon Tatham </td>
			<td> fixed.fd font on which the emulator&#8217;s font is based </td>
		</tr>
		<tr>
			<td> Gilles Vollant </td>
			<td> Minizip library </td>
		</tr>
		<tr>
			<td> Vincent van Dam </td>
			<td> fMSX <span class="caps">SDL</span> (code dealing with sound emulation) </td>
		</tr>
		<tr>
			<td> Mitsutaka Okazaki </td>
			<td> PSG/SCC/MSXMUSIC sound emulation engine </td>
		</tr>
		<tr>
			<td> Tatsuyuki Satoh </td>
			<td> MSXAUDIO sound emulation engine </td>
		</tr>
		<tr>
			<td> Ruka </td>
			<td> PNG saving/loading code </td>
		</tr>
	</table>




	<h2 id="Thanks">Thanks</h2>


	<p>fMSX <span class="caps">PSP</span> would not be possible without prior work of many other hackers. I have benefited from the source code of the following <span class="caps">PSP</span> programs:</p>


	<table>
		<tr>
			<td> fMSX <span class="caps">SDL</span> </td>
			<td> Vincent van Dam </td>
		</tr>
		<tr>
			<td> PSPMSX </td>
			<td> zx81 </td>
		</tr>
		<tr>
			<td> NesterJ </td>
			<td> Ruka </td>
		</tr>
		<tr>
			<td> Snes9XTYL </td>
			<td> YoyoFR, Thunder, Laxer </td>
		</tr>
		<tr>
			<td> (CPS1/CPS2/MVS)PSP </td>
			<td> NJ </td>
		</tr>
		<tr>
			<td> PSPSDK examples </td>
		</tr>
	</table>




	<p>Some personal thanks are due to the authors of <span class="caps">SNES9XTYL</span>, DGEN for <span class="caps">PSP</span> and [CPSx|MVS]PSP emulators &#8211; the hard work evident in the polished interfaces of the emulators is inspiring, if nothing else. fMSX <span class="caps">PSP</span> was an attempt to bring a similar interface to <span class="caps">MSX</span> emulation (whether it&#8217;s achieved that or not is anyone&#8217;s guess :)</p>


	<p>Special thanks are also due to jburton of dcemu.co.uk forums for all his helpful feedback.</p>

    </div>

    <div id="footer">Akop Karapetyan, 2007</div>

  </body>
</html>

